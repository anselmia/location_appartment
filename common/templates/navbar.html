{% load static %}
{% load i18n %}
{% get_current_language as LANGUAGE_CODE %}
<header class="navbar">
    <div class="logo ml-3">
        <a href="{% url 'common:home' %}">
            <picture>
                <source srcset="{% static 'logement/img/logo.webp' %}" type="image/webp">
                <img src="{% static 'logement/img/logo.jpg' %}"
                     alt="Logement B&B"
                     class="logo-img"
                     loading="lazy">
            </picture>
        </a>
    </div>
    <nav role="navigation" aria-label="{% trans 'Menu principal' %}">
        <div class="nav-toggle" id="navToggle" aria-label="Toggle navigation">&#9776;</div>
        <div class="nav-links" id="navLinks">
            <!-- Close Button for Mobile -->
            <div class="nav-close d-md-none text-end px-3 py-2 w-100">
                <span style="cursor:pointer"
                      onclick="document.getElementById('navLinks').classList.remove('show')">âœ•</span>
            </div>
            <a href="{% url 'common:home' %}">{% trans "Accueil" %}</a>
            
            <div class="dropdown">
                <a href="#"
                   class="dropdown-toggle"
                   role="button"
                   aria-expanded="false"
                   aria-haspopup="true">{% trans "RÃ©server" %}</a>
                <div class="dropdown-menu">
                    <a href="{% url 'logement:logement_search' %}">{% trans "Un logement" %}</a>
                    <a href="{% url 'activity:search' %}">{% trans "Une activitÃ©" %}</a>
                </div>
            </div>
            <!-- Nous choisir -->
            <div class="dropdown">
                <a href="#"
                   class="dropdown-toggle"
                   role="button"
                   aria-expanded="false"
                   aria-haspopup="true">{% trans "Nous Choisir" %}</a>
                <div class="dropdown-menu">
                    <a href="{% url 'common:join_owner' %}">{% trans "HÃ´tes" %}</a>
                    <a href="{% url 'common:join_user' %}">{% trans "Voyageurs" %}</a>
                    <a href="{% url 'conciergerie:customer_list' %}">{% trans "Nos Conciergeries" %}</a>
                    <a href="{% url 'activity:partner_list_customer' %}">{% trans "Nos Partenaires" %}</a>
                </div>
            </div>
            {% if user.is_authenticated %}
                {% if user.is_superuser or user.is_admin or user.is_owner or user.has_conciergerie %}
                    <div class="dropdown">
                        <a href="#"
                           class="dropdown-toggle"
                           role="button"
                           aria-expanded="false"
                           aria-haspopup="true">{% trans "Logements" %}</a>
                        <div class="dropdown-menu">
                            <a href="{% url 'logement:dashboard' %}">{% trans "Tableau de bord" %}</a>
                            <a href="{% url 'logement:calendar' %}">{% trans "Calendrier" %}</a>
                            <a href="{% url 'reservation:reservation_dashboard' %}">{% trans "RÃ©servations" %}</a>
                            <a href="{% url 'logement:manage_discounts' %}">{% trans "RÃ©ductions" %}</a>
                            <a href="{% url 'logement:revenu' %}">{% trans "Revenus" %}</a>
                        </div>
                    </div>
                {% endif %}
                {% if user.is_superuser or user.is_admin or user.has_partners %}
                    <div class="dropdown">
                        <a href="#"
                           class="dropdown-toggle"
                           role="button"
                           aria-expanded="false"
                           aria-haspopup="true">{% trans "ActivitÃ©s" %}</a>
                        <div class="dropdown-menu">
                            <a href="{% url 'activity:activity_dashboard' %}">{% trans "Tableau de bord" %}</a>
                            <a href="{% url 'activity:activity_calendar' %}">{% trans "Calendrier" %}</a>
                            <a href="{% url 'activity:reservation_dashboard' %}">{% trans "RÃ©servations" %}</a>
                            <a href="{% url 'activity:manage_discounts' %}">{% trans "RÃ©ductions" %}</a>
                            <a href="{% url 'activity:revenu' %}">{% trans "Revenus" %}</a>
                        </div>
                    </div>
                {% endif %}
                {% if user.is_superuser or user.is_admin %}
                    <div class="dropdown">
                        <a href="#"
                           class="dropdown-toggle"
                           role="button"
                           aria-expanded="false"
                           aria-haspopup="true">{% trans "Admin" %}</a>
                        <div class="dropdown-menu">
                            <a href="{% url 'administration:financial_dashboard' %}">{% trans "Tableau de bord" %}</a>
                            <a href="{% url 'administration:edit_entreprise' %}">{% trans "Entreprise" %}</a>
                            <a href="{% url 'administration:homepage_admin_view' %}">{% trans "Home page" %}</a>
                            <a href="{% url 'reservation:manage_reservations' %}">{% trans "Gestion des rÃ©servations (Logements)" %}</a>
                            <a href="{% url 'activity:manage_reservations' %}">{% trans "Gestion des rÃ©servations (ActivitÃ©s)" %}</a>
                            <a href="{% url 'accounts:user_update_view' %}">{% trans "Gestion des Utilisateurs" %}</a>
                            <a href="{% url 'administration:offers' %}">{% trans "Offres" %}</a>
                            <a href="{% url 'payment:payment_tasks' %}">{% trans "Transactions" %}</a>
                            <a href="{% url 'conciergerie:list_conciergeries' %}">{% trans "Conciergeries" %}</a>
                            <a href="{% url 'activity:list_partners' %}">{% trans "Partenaires" %}</a>
                            <a href="{% url 'administration:huey_tasks_status' %}">{% trans "Tasks" %}</a>
                            <a href="{% url 'administration:traffic' %}">{% trans "Traffic" %}</a>
                            <a href="{% url 'administration:log_viewer' %}">{% trans "Logs" %}</a>
                            <a href="{% url 'administration:test_email' %}">{% trans "Test Emails" %}</a>
                        </div>
                    </div>
                {% endif %}
                <div class="dropdown">
                    <a href="#"
                       class="dropdown-toggle"
                       role="button"
                       aria-expanded="false"
                       aria-haspopup="true">{% trans "Mon compte" %} ({{ user.username }})</a>
                    <div class="dropdown-menu">
                        <a href="{% url 'accounts:dashboard' %}">{% trans "Tableau de bord" %}</a>
                        <a href="{% url 'accounts:messages' %}">ğŸ“¬ {% trans "Messagerie" %}</a>
                        <a href="{% url 'accounts:logout' %}">{% trans "DÃ©connexion" %}</a>
                    </div>
                </div>
            {% else %}
                <a href="{% url 'accounts:login' %}">{% trans "Connexion" %}</a>
            {% endif %}
            <!-- Language Switcher -->
            <form action="{% url 'logement:set_language' %}"
                  method="post"
                  class="lang-form">
                {% csrf_token %}
                <input type="hidden" name="next" value="{{ request.path }}">
                <button type="submit"
                        name="language"
                        value="fr"
                        class="{% if LANGUAGE_CODE == 'fr' %}active{% endif %}">
                    <img src="{% static 'logement/img/flags/fr.svg' %}" alt="FranÃ§ais">
                </button>
                <button type="submit"
                        name="language"
                        value="en"
                        class="{% if LANGUAGE_CODE == 'en' %}active{% endif %}">
                    <img src="{% static 'logement/img/flags/en.svg' %}" alt="English">
                </button>
                <button type="submit"
                        name="language"
                        value="es"
                        class="{% if LANGUAGE_CODE == 'es' %}active{% endif %}">
                    <img src="{% static 'logement/img/flags/es.svg' %}" alt="EspaÃ±ol">
                </button>
            </form>
        </div>
    </nav>
</header>

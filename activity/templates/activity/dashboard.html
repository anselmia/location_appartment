{% extends "base.html" %}
{% load static %}
{% block title %}Gestion des activit√©s ‚Äì {{ entreprise.name }}{% endblock %}
{% block meta_description %}
    Administrez vos activit√©s sur {{ entreprise.name }}‚ÄØ: visualisez, ajoutez, modifiez ou d√©sactivez vos activit√©s √† Nice et sur la C√¥te d‚ÄôAzur. G√©rez facilement vos offres et optimisez votre calendrier.
{% endblock %}
{% block extrahead %}
    {{ block.super }}
    <link rel="stylesheet"
          href="{% static 'activity/css/activity_dashboard.css' %}">
{% endblock extrahead %}
{% block content %}
    <div class="admin-activity-container">
        <div class="admin-header">
            <div class="admin-header-title">
                <h1>Gestion des activit√©s</h1>
                <p class="admin-subtitle">G√©rez vos activit√©s, ajoutez ou modifiez les activit√©s propos√©es</p>
            </div>
            <a href="{% url 'activity:create_activity' %}" class="btn btn-primary">‚ûï Nouvelle activit√©</a>
        </div>
        {% if activities %}
            <div class="activity-grid">
                {% for activity in activities %}
                    <div class="activity-card position-relative">
                        <form method="post"
                              action="{% url 'activity:delete_activity' activity.id %}"
                              onsubmit="return confirm('√ätes-vous s√ªr de vouloir supprimer cette activit√© ? Cette action est irr√©versible.');"
                              class="position-absolute top-0 end-0 mt-2 me-2"
                              style="z-index:2">
                            {% csrf_token %}
                            <button type="submit"
                                    class="btn btn-danger btn-circle btn-sm shadow-sm"
                                    title="Supprimer cette activit√©"
                                    style="width:2rem;
                                           height:2rem;
                                           display:flex;
                                           align-items:center;
                                           justify-content:center">
                                <i class="bi bi-trash"></i>
                            </button>
                        </form>
                        <a href="{% url 'activity:update_activity' activity.id %}"
                           class="activity-card-link">
                            {% if activity.photos.first %}
                                <img src="{{ activity.photos.first.image.url }}"
                                     alt="{{ activity.name }}"
                                     class="activity-thumb"
                                     width="100%"
                                     height="180">
                            {% else %}
                                <div class="activity-thumb placeholder">üì∑</div>
                            {% endif %}
                            <div class="activity-card-body">
                                <h3 class="activity-title">{{ activity.name }}</h3>
                                <p class="activity-city">
                                    {% if activity.location %}
                                        {{ activity.location.name }}
                                    {% else %}
                                        ‚Äî
                                    {% endif %}
                                </p>
                                <div class="activity-details">
                                    <span>üí∞ {{ activity.price }} ‚Ç¨</span>
                                    <span>‚è± {{ activity.duration }} min</span>
                                    <span>üë§ {{ activity.max_participants }} pers.</span>
                                </div>
                                <div class="activity-tags">
                                    <span class="tag type">{{ activity.category.name }}</span>
                                    <span class="tag status {% if not activity.is_active %}inactif{% endif %}">
                                        {% if activity.is_active %}
                                            Active
                                        {% else %}
                                            Inactif
                                        {% endif %}
                                    </span>
                                </div>
                            </div>
                        </a>
                    </div>
                {% endfor %}
            </div>
            <div class="d-flex justify-content-center mt-4">
                <nav aria-label="Pagination">
                    <ul class="pagination-list">
                        {% if page_obj.has_previous %}
                            <li class="page-item">
                                <a href="?page={{ page_obj.previous_page_number }}"
                                   aria-label="Pr√©c√©dent">¬´</a>
                            </li>
                        {% endif %}
                        {% for num in page_obj.paginator.page_range %}
                            <li class="page-item {% if page_obj.number == num %}active{% endif %}">
                                <a href="?page={{ num }}">{{ num }}</a>
                            </li>
                        {% endfor %}
                        {% if page_obj.has_next %}
                            <li class="page-item">
                                <a href="?page={{ page_obj.next_page_number }}" aria-label="Suivant">¬ª</a>
                            </li>
                        {% endif %}
                    </ul>
                </nav>
            </div>
        {% else %}
            <div class="alert alert-info mt-4">Aucune activit√© enregistr√©e pour le moment.</div>
        {% endif %}
    </div>
{% endblock content %}
